/*
 * HTML5 export buttons for Buttons and DataTables.
 * 2016 SpryMedia Ltd - datatables.net/license
 *
 * FileSaver.js (1.3.3) - MIT license
 * Copyright © 2016 Eli Grey - http://eligrey.com
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net","datatables.net-buttons"],function(b){return a(b,window,document)})}else{if(typeof exports==="object"){module.exports=function(e,b,c,d){if(!e){e=window}if(!b||!b.fn.dataTable){b=require("datatables.net")(e,b).$}if(!b.fn.dataTable.Buttons){require("datatables.net-buttons")(e,b)}return a(b,e,e.document,c,d)}}else{a(jQuery,window,document)}}}(function(a,x,q,s,u,w){var p=a.fn.dataTable;function i(){return s||x.JSZip}function k(){return u||x.pdfMake}p.Buttons.pdfMake=function(t){if(!t){return k()}u=m_ake};p.Buttons.jszip=function(t){if(!t){return i()}s=t};var l=(function(N){if(typeof N==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var C=N.document,G=function(){return N.URL||N.webkitURL||N},K=C.createElementNS("http://www.w3.org/1999/xhtml","a"),z="download" in K,A=function(P){var O=new MouseEvent("click");P.dispatchEvent(O)},I=/constructor/i.test(N.HTMLElement)||N.safari,H=/CriOS\/[\d]+/.test(navigator.userAgent),M=function(O){(N.setImmediate||N.setTimeout)(function(){throw O},0)},E="application/octet-stream",t=1000*40,J=function(O){var P=function(){if(typeof O==="string"){G().revokeObjectURL(O)}else{O.remove()}};setTimeout(P,t)},B=function(R,P,O){P=[].concat(P);var S=P.length;while(S--){var T=R["on"+P[S]];if(typeof T==="function"){try{T.call(R,O||R)}catch(Q){M(Q)}}}},y=function(O){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(O.type)){return new Blob([String.fromCharCode(65279),O],{type:O.type})}return O},D=function(O,T,U){if(!U){O=y(O)}var Q=this,W=O.type,R=W===E,V,P=function(){B(Q,"writestart progress write writeend".split(" "))},S=function(){if((H||(R&&I))&&N.FileReader){var Y=new FileReader();Y.onloadend=function(){var aa=H?Y.result:Y.result.replace(/^data:[^;]*;/,"data:attachment/file;");var Z=N.open(aa,"_blank");if(!Z){N.location.href=aa}aa=w;Q.readyState=Q.DONE;P()};Y.readAsDataURL(O);Q.readyState=Q.INIT;return}if(!V){V=G().createObjectURL(O)}if(R){N.location.href=V}else{var X=N.open(V,"_blank");if(!X){N.location.href=V}}Q.readyState=Q.DONE;P();J(V)};Q.readyState=Q.INIT;if(z){V=G().createObjectURL(O);setTimeout(function(){K.href=V;K.download=T;A(K);P();J(V);Q.readyState=Q.DONE});return}S()},F=D.prototype,L=function(O,P,Q){return new D(O,P||O.name||"download",Q)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(O,P,Q){P=P||O.name||"download";if(!Q){O=y(O)}return navigator.msSaveOrOpenBlob(O,P)}}F.abort=function(){};F.readyState=F.INIT=0;F.WRITING=1;F.DONE=2;F.error=F.onwritestart=F.onprogress=F.onwrite=F.onabort=F.onerror=F.onwriteend=null;return L}(typeof self!=="undefined"&&self||typeof x!=="undefined"&&x||this.content));p.fileSave=l;var n=function(t){var y="Sheet1";if(t.sheetName){y=t.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")}return y};var j=function(t){return t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"};var f=function(B,z){var I=j(z);var A=B.buttons.exportData(z.exportOptions);var y=z.fieldBoundary;var K=z.fieldSeparator;var J=new RegExp(y,"g");var C=z.escapeChar!==w?z.escapeChar:"\\";var H=function(L){var O="";for(var M=0,N=L.length;M<N;M++){if(M>0){O+=K}O+=y?y+(""+L[M]).replace(J,C+y)+y:L[M]}return O};var E=z.header?H(A.header)+I:"";var D=z.footer&&A.footer?I+H(A.footer):"";var t=[];for(var F=0,G=A.body.length;F<G;F++){t.push(H(A.body[F]))}return{str:E+t.join(I)+D,rows:t.length}};var h=function(){var t=navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&navigator.userAgent.indexOf("Opera")===-1;if(!t){return false}var y=navigator.userAgent.match(/AppleWebKit\/(\d+\.\d+)/);if(y&&y.length>1&&y[1]*1<603.1){return true}return false};function o(y){var z="A".charCodeAt(0);var A="Z".charCodeAt(0);var t=A-z+1;var B="";while(y>=0){B=String.fromCharCode(y%t+z)+B;y=Math.floor(y/t)-1}return B}try{var m=new XMLSerializer();var g}catch(v){}function b(y,t){if(g===w){g=m.serializeToString(a.parseXML(r["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r")===-1}a.each(t,function(F,I){if(a.isPlainObject(I)){var G=y.folder(F);b(G,I)}else{if(g){var J=I.childNodes[0];var D,E;var B=[];for(D=J.attributes.length-1;D>=0;D--){var A=J.attributes[D].nodeName;var C=J.attributes[D].nodeValue;if(A.indexOf(":")!==-1){B.push({name:A,value:C});J.removeAttribute(A)}}for(D=0,E=B.length;D<E;D++){var z=I.createAttribute(B[D].name.replace(":","_dt_b_namespace_token_"));z.value=B[D].value;J.setAttributeNode(z)}}var H=m.serializeToString(I);if(g){if(H.indexOf("<?xml")===-1){H='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+H}H=H.replace(/_dt_b_namespace_token_/g,":");H=H.replace(/xmlns:NS[\d]+="" NS[\d]+:/g,"")}H=H.replace(/<([^<>]*?) xmlns=""([^<>]*?)>/g,"<$1 $2>");y.file(F,H)}})}function c(t,y,z){var A=t.createElement(y);if(z){if(z.attr){a(A).attr(z.attr)}if(z.children){a.each(z.children,function(B,C){A.appendChild(C)})}if(z.text!==null&&z.text!==w){A.appendChild(t.createTextNode(z.text))}}return A}function d(y,t){var D=y.header[t].length;var B,C,F;if(y.footer&&y.footer[t].length>D){D=y.footer[t].length}for(var z=0,A=y.body.length;z<A;z++){var E=y.body[z][t];F=E!==null&&E!==w?E.toString():"";if(F.indexOf("\n")!==-1){C=F.split("\n");C.sort(function(G,H){return H.length-G.length});B=C[0].length}else{B=F.length}if(B>D){D=B}if(D>40){return 54}}D*=1.35;return D>6?D:6}var r={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets><definedNames/></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/><mergeCells count="0"/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="6"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill><patternFill patternType="none" /></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="67"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'};var e=[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(t){return t/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(t){return t/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(t){return -1*t.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(t){return -1*t.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64}];p.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(D,C,y,A){this.processing(true);var N=this;var E=f(C,A);var G=C.buttons.exportInfo(A);var I=j(A);var J=E.str;var F=a("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});if(G.title){J=G.title+I+I+J}if(G.messageTop){J=G.messageTop+I+I+J}if(G.messageBottom){J=J+I+I+G.messageBottom}if(A.customize){J=A.customize(J,A,C)}var M=a("<textarea readonly/>").val(J).appendTo(F);if(q.queryCommandSupported("copy")){F.appendTo(C.table().container());M[0].focus();M[0].select();try{var K=q.execCommand("copy");F.remove();if(K){C.buttons.info(C.i18n("buttons.copyTitle","Copy to clipboard"),C.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},E.rows),2000);this.processing(false);return}}catch(L){}}var H=a("<span>"+C.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(F);C.buttons.info(C.i18n("buttons.copyTitle","Copy to clipboard"),H,0);M[0].focus();M[0].select();var B=a(H).closest(".dt-button-info");var z=function(){B.off("click.buttons-copy");a(q).off(".buttons-copy");C.buttons.info(false)};B.on("click.buttons-copy",z);a(q).on("keydown.buttons-copy",function(t){if(t.keyCode===27){z();N.processing(false)}}).on("copy.buttons-copy cut.buttons-copy",function(){z();N.processing(false)})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:true,footer:false,title:"*",messageTop:"*",messageBottom:"*"};p.ext.buttons.csvHtml5={bom:false,className:"buttons-csv buttons-html5",available:function(){return x.FileReader!==w&&x.Blob},text:function(t){return t.i18n("buttons.csv","CSV")},action:function(B,A,t,z){this.processing(true);var D=f(A,z).str;var C=A.buttons.exportInfo(z);var y=z.charset;if(z.customize){D=z.customize(D,z,A)}if(y!==false){if(!y){y=q.characterSet||q.charset}if(y){y=";charset="+y}}else{y=""}if(z.bom){D="\ufeff"+D}l(new Blob([D],{type:"text/csv"+y}),C.filename,true);this.processing(false)},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:true,footer:false};p.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return x.FileReader!==w&&i()!==w&&!h()&&m},text:function(t){return t.i18n("buttons.excel","Excel")},action:function(G,F,y,A){this.processing(true);var T=this;var S=0;var E,D;var I=function(Z){var Y=r[Z];return a.parseXML(Y)};var P=I("xl/worksheets/sheet1.xml");var Q=P.getElementsByTagName("sheetData")[0];var V={_rels:{".rels":I("_rels/.rels")},xl:{_rels:{"workbook.xml.rels":I("xl/_rels/workbook.xml.rels")},"workbook.xml":I("xl/workbook.xml"),"styles.xml":I("xl/styles.xml"),worksheets:{"sheet1.xml":P}},"[Content_Types].xml":I("[Content_Types].xml")};var C=F.buttons.exportData(A.exportOptions);var B,R;var t=function(af){B=S+1;R=c(P,"row",{attr:{r:B}});for(var aa=0,ab=af.length;aa<ab;aa++){var Z=o(aa)+""+B;var Y=null;if(af[aa]===null||af[aa]===w||af[aa]===""){if(A.createEmptyCells===true){af[aa]=""}else{continue}}var ae=af[aa];af[aa]=a.trim(af[aa]);for(var ac=0,ad=e.length;ac<ad;ac++){var ag=e[ac];if(af[aa].match&&!af[aa].match(/^0\d+/)&&af[aa].match(ag.match)){var ai=af[aa].replace(/[^\d\.\-]/g,"");if(ag.fmt){ai=ag.fmt(ai)}Y=c(P,"c",{attr:{r:Z,s:ag.style},children:[c(P,"v",{text:ai})]});break}}if(!Y){if(typeof af[aa]==="number"||(af[aa].match&&af[aa].match(/^-?\d+(\.\d+)?$/)&&!af[aa].match(/^0\d+/))){Y=c(P,"c",{attr:{t:"n",r:Z},children:[c(P,"v",{text:af[aa]})]})}else{var ah=!ae.replace?ae:ae.replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"");Y=c(P,"c",{attr:{t:"inlineStr",r:Z},children:{row:c(P,"is",{children:{row:c(P,"t",{text:ah,attr:{"xml:space":"preserve"}})}})}})}}R.appendChild(Y)}Q.appendChild(R);S++};if(A.customizeData){A.customizeData(C)}var N=function(aa,Y){var Z=a("mergeCells",P);Z[0].appendChild(c(P,"mergeCell",{attr:{ref:"A"+aa+":"+o(Y)+aa}}));Z.attr("count",parseFloat(Z.attr("count"))+1);a("row:eq("+(aa-1)+") c",P).attr("s","51")};var H=F.buttons.exportInfo(A);if(H.title){t([H.title],S);N(S,C.header.length-1)}if(H.messageTop){t([H.messageTop],S);N(S,C.header.length-1)}if(A.header){t(C.header,S);a("row:last c",P).attr("s","2")}E=S;for(var O=0,K=C.body.length;O<K;O++){t(C.body[O],S)}D=S;if(A.footer&&C.footer){t(C.footer,S);a("row:last c",P).attr("s","2")}if(H.messageBottom){t([H.messageBottom],S);N(S,C.header.length-1)}var z=c(P,"cols");a("worksheet",P).prepend(z);for(var J=0,L=C.header.length;J<L;J++){z.appendChild(c(P,"col",{attr:{min:J+1,max:J+1,width:d(C,J),customWidth:1}}))}var U=V.xl["workbook.xml"];a("sheets sheet",U).attr("name",n(A));if(A.autoFilter){a("mergeCells",P).before(c(P,"autoFilter",{attr:{ref:"A"+E+":"+o(C.header.length-1)+D}}));a("definedNames",U).append(c(U,"definedName",{attr:{name:"_xlnm._FilterDatabase",localSheetId:"0",hidden:1},text:n(A)+"!$A$"+E+":"+o(C.header.length-1)+D}))}if(A.customize){A.customize(V,A,F)}if(a("mergeCells",P).children().length===0){a("mergeCells",P).remove()}var M=i();var W=new M();var X={type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};b(W,V);if(W.generateAsync){W.generateAsync(X).then(function(Y){l(Y,H.filename);T.processing(false)})}else{l(W.generate(X),H.filename);this.processing(false)}},filename:"*",extension:".xlsx",exportOptions:{},header:true,footer:false,title:"*",messageTop:"*",messageBottom:"*",createEmptyCells:false,autoFilter:false,sheetName:""};p.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return x.FileReader!==w&&k()},text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(C,B,t,y){this.processing(true);var I=this;var z=B.buttons.exportData(y.exportOptions);var F=B.buttons.exportInfo(y);var H=[];if(y.header){H.push(a.map(z.header,function(J){return{text:typeof J==="string"?J:J+"",style:"tableHeader"}}))}for(var D=0,E=z.body.length;D<E;D++){H.push(a.map(z.body[D],function(J){if(J===null||J===w){J=""}return{text:typeof J==="string"?J:J+"",style:D%2?"tableBodyEven":"tableBodyOdd"}}))}if(y.footer&&z.footer){H.push(a.map(z.footer,function(J){return{text:typeof J==="string"?J:J+"",style:"tableFooter"}}))}var A={pageSize:y.pageSize,pageOrientation:y.orientation,content:[{table:{headerRows:1,body:H},layout:"noBorders"}],styles:{tableHeader:{bold:true,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:true,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};if(F.messageTop){A.content.unshift({text:F.messageTop,style:"message",margin:[0,0,0,12]})}if(F.messageBottom){A.content.push({text:F.messageBottom,style:"message",margin:[0,0,0,12]})}if(F.title){A.content.unshift({text:F.title,style:"title",margin:[0,0,0,12]})}if(y.customize){y.customize(A,y,B)}var G=k().createPdf(A);if(y.download==="open"&&!h()){G.open()}else{G.download(F.filename)}this.processing(false)},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:true,footer:false,messageTop:"*",messageBottom:"*",customize:null,download:"download"};return p.Buttons}));