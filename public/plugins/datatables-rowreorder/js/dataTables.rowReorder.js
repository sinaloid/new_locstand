/* RowReorder 1.2.6
 * 2015-2019 SpryMedia Ltd - datatables.net/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(b){return a(b,window,document)})}else{if(typeof exports==="object"){module.exports=function(c,b){if(!c){c=window}if(!b||!b.fn.dataTable){b=require("datatables.net")(c,b).$}return a(b,c,c.document)}}else{a(jQuery,window,document)}}}(function(a,g,d,f){var c=a.fn.dataTable;var e=function(h,j){if(!c.versionCheck||!c.versionCheck("1.10.8")){throw"DataTables RowReorder requires DataTables 1.10.8 or newer"}this.c=a.extend(true,{},c.defaults.rowReorder,e.defaults,j);this.s={bodyTop:null,dt:new c.Api(h),getDataFn:c.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:c.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0,documentOuterHeight:0,domCloneOuterHeight:0};this.dom={clone:null,dtScroll:a("div.dataTables_scrollBody",this.s.dt.table().container())};var k=this.s.dt.settings()[0];var i=k.rowreorder;if(i){return i}k.rowreorder=this;this._constructor()};a.extend(e.prototype,{_constructor:function(){var j=this;var h=this.s.dt;var i=a(h.table().node());if(i.css("position")==="static"){i.css("position","relative")}a(h.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(k){if(!j.c.enable){return}if(a(k.target).is(j.c.excludedChildren)){return true}var m=a(this).closest("tr");var l=h.row(m);if(l.any()){j._emitEvent("pre-row-reorder",{node:l.node(),index:l.index()});j._mouseDown(k,m);return false}});h.on("destroy.rowReorder",function(){a(h.table().container()).off(".rowReorder");h.off(".rowReorder")})},_cachePositions:function(){var h=this.s.dt;var i=a(h.table().node()).find("thead").outerHeight();var k=a.unique(h.rows({page:"current"}).nodes().toArray());var l=a.map(k,function(n,m){return a(n).position().top-i});var j=a.map(l,function(n,m){return l.length<m-1?(n+l[m+1])/2:(n+n+a(h.row(":last-child").node()).outerHeight())/2});this.s.middles=j;this.s.bodyTop=a(h.table().body()).offset().top;this.s.windowHeight=a(g).height();this.s.documentOuterHeight=a(d).outerHeight()},_clone:function(m){var i=this.s.dt;var h=a(i.table().node().cloneNode(false)).addClass("dt-rowReorder-float").append("<tbody/>").append(m.clone(false));var l=m.outerWidth();var k=m.outerHeight();var j=m.children().map(function(){return a(this).width()});h.width(l).height(k).find("tr").children().each(function(n){this.style.width=j[n]+"px"});h.appendTo("body");this.dom.clone=h;this.s.domCloneOuterHeight=h.outerHeight()},_clonePosition:function(h){var l=this.s.start;var n=this._eventToPage(h,"Y")-l.top;var j=this._eventToPage(h,"X")-l.left;var k=this.c.snapX;var i;var m=n+l.offsetTop;if(k===true){i=l.offsetLeft}else{if(typeof k==="number"){i=l.offsetLeft+k}else{i=j+l.offsetLeft}}if(m<0){m=0}else{if(m+this.s.domCloneOuterHeight>this.s.documentOuterHeight){m=this.s.documentOuterHeight-this.s.domCloneOuterHeight}}this.dom.clone.css({top:m,left:i})},_emitEvent:function(i,h){this.s.dt.iterator("table",function(j,k){a(j.nTable).triggerHandler(i+".dt",h)})},_eventToPage:function(h,i){if(h.type.indexOf("touch")!==-1){return h.originalEvent.touches[0]["page"+i]}return h["page"+i]},_mouseDown:function(i,m){var n=this;var h=this.s.dt;var l=this.s.start;var j=m.offset();l.top=this._eventToPage(i,"Y");l.left=this._eventToPage(i,"X");l.offsetTop=j.top;l.offsetLeft=j.left;l.nodes=a.unique(h.rows({page:"current"}).nodes().toArray());this._cachePositions();this._clone(m);this._clonePosition(i);this.dom.target=m;m.addClass("dt-rowReorder-moving");a(d).on("mouseup.rowReorder touchend.rowReorder",function(o){n._mouseUp(o)}).on("mousemove.rowReorder touchmove.rowReorder",function(o){n._mouseMove(o)});if(a(g).width()===a(d).width()){a(d.body).addClass("dt-rowReorder-noOverflow")}var k=this.dom.dtScroll;this.s.scroll={windowHeight:a(g).height(),windowWidth:a(g).width(),dtTop:k.length?k.offset().top:null,dtLeft:k.length?k.offset().left:null,dtHeight:k.length?k.outerHeight():null,dtWidth:k.length?k.outerWidth():null}},_mouseMove:function(l){this._clonePosition(l);var j=this._eventToPage(l,"Y")-this.s.bodyTop;var p=this.s.middles;var o=null;var k=this.s.dt;var h=k.table().body();for(var m=0,n=p.length;m<n;m++){if(j<p[m]){o=m;break}}if(o===null){o=p.length}if(this.s.lastInsert===null||this.s.lastInsert!==o){if(o===0){this.dom.target.prependTo(h)}else{var q=a.unique(k.rows({page:"current"}).nodes().toArray());if(o>this.s.lastInsert){this.dom.target.insertAfter(q[o-1])}else{this.dom.target.insertBefore(q[o])}}this._cachePositions();this.s.lastInsert=o}this._shiftScroll(l)},_mouseUp:function(l){var y=this;var k=this.s.dt;var r,u;var h=this.c.dataSrc;this.dom.clone.remove();this.dom.clone=null;this.dom.target.removeClass("dt-rowReorder-moving");a(d).off(".rowReorder");a(d.body).removeClass("dt-rowReorder-noOverflow");clearInterval(this.s.scrollInterval);this.s.scrollInterval=null;var w=this.s.start.nodes;var m=a.unique(k.rows({page:"current"}).nodes().toArray());var t={};var p=[];var j=[];var q=this.s.getDataFn;var v=this.s.setDataFn;for(r=0,u=w.length;r<u;r++){if(w[r]!==m[r]){var s=k.row(m[r]).id();var n=k.row(m[r]).data();var x=k.row(w[r]).data();if(s){t[s]=q(x)}p.push({node:m[r],oldData:q(n),newData:q(x),newPosition:r,oldPosition:a.inArray(m[r],w)});j.push(m[r])}}var o=[p,{dataSrc:h,nodes:j,values:t,triggerRow:k.row(this.dom.target),originalEvent:l}];this._emitEvent("row-reorder",o);var z=function(){if(y.c.update){for(r=0,u=p.length;r<u;r++){var i=k.row(p[r].node);var A=i.data();v(A,p[r].newData);k.columns().every(function(){if(this.dataSrc()===h){k.cell(p[r].node,this.index()).invalidate("data")}})}y._emitEvent("row-reordered",o);k.draw(false)}};if(this.c.editor){this.c.enable=false;this.c.editor.edit(j,false,a.extend({submit:"changed"},this.c.formOptions)).multiSet(h,t).one("preSubmitCancelled.rowReorder",function(){y.c.enable=true;y.c.editor.off(".rowReorder");k.draw(false)}).one("submitUnsuccessful.rowReorder",function(){k.draw(false)}).one("submitSuccess.rowReorder",function(){z()}).one("submitComplete",function(){y.c.enable=true;y.c.editor.off(".rowReorder")}).submit()}else{z()}},_shiftScroll:function(k){var o=this;var i=this.s.dt;var m=this.s.scroll;var l=false;var n=5;var h=65;var q=k.pageY-d.body.scrollTop,p,j;if(q<h){p=n*-1}else{if(q>m.windowHeight-h){p=n}}if(m.dtTop!==null&&k.pageY<m.dtTop+h){j=n*-1}else{if(m.dtTop!==null&&k.pageY>m.dtTop+m.dtHeight-h){j=n}}if(p||j){m.windowVert=p;m.dtVert=j;l=true}else{if(this.s.scrollInterval){clearInterval(this.s.scrollInterval);this.s.scrollInterval=null}}if(!this.s.scrollInterval&&l){this.s.scrollInterval=setInterval(function(){if(m.windowVert){d.body.scrollTop+=m.windowVert}if(m.dtVert){var r=o.dom.dtScroll[0];if(m.dtVert){r.scrollTop+=m.dtVert}}},20)}}});e.defaults={dataSrc:0,editor:null,enable:true,formOptions:{},selector:"td:first-child",snapX:false,update:true,excludedChildren:"a"};var b=a.fn.dataTable.Api;b.register("rowReorder()",function(){return this});b.register("rowReorder.enable()",function(h){if(h===f){h=true}return this.iterator("table",function(i){if(i.rowreorder){i.rowreorder.c.enable=h}})});b.register("rowReorder.disable()",function(){return this.iterator("table",function(h){if(h.rowreorder){h.rowreorder.c.enable=false}})});e.version="1.2.6";a.fn.dataTable.RowReorder=e;a.fn.DataTable.RowReorder=e;a(d).on("init.dt.dtr",function(i,m,k){if(i.namespace!=="dt"){return}var j=m.oInit.rowReorder;var h=c.defaults.rowReorder;if(j||h){var l=a.extend({},j,h);if(j!==false){new e(m,l)}}});return e}));