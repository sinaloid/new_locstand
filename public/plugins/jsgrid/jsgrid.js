(function(A,a,z){var i="JSGrid",j=i,l="JSGridItem",k="JSGridEditRow",x="asc",y="desc",e="{first}",t="{pages}",u="{prev}",p="{next}",m="{last}",s="{pageIndex}",r="{pageCount}",h="{itemCount}",c="javascript:void(0);";var f=function(C,B){if(a.isFunction(C)){return C.apply(B,a.makeArray(arguments).slice(2))}return C};var q=function(C){var B=a.Deferred();if(C&&C.then){C.then(function(){B.resolve.apply(B,arguments)},function(){B.reject.apply(B,arguments)})}else{B.resolve(C)}return B.promise()};var b={loadData:a.noop,insertItem:a.noop,updateItem:a.noop,deleteItem:a.noop};function g(D,C){var B=a(D);B.data(j,this);this._container=B;this.data=[];this.fields=[];this._editingRow=null;this._sortField=null;this._sortOrder=x;this._firstDisplayingPage=1;this._init(C);this.render()}g.prototype={width:"auto",height:"auto",updateOnResize:true,rowClass:a.noop,rowRenderer:null,rowClick:function(B){if(this.editing){this.editItem(a(B.event.target).closest("tr"))}},rowDoubleClick:a.noop,noDataContent:"Not found",noDataRowClass:"jsgrid-nodata-row",heading:true,headerRowRenderer:null,headerRowClass:"jsgrid-header-row",headerCellClass:"jsgrid-header-cell",filtering:false,filterRowRenderer:null,filterRowClass:"jsgrid-filter-row",inserting:false,insertRowRenderer:null,insertRowClass:"jsgrid-insert-row",editing:false,editRowRenderer:null,editRowClass:"jsgrid-edit-row",confirmDeleting:true,deleteConfirm:"Are you sure?",selecting:true,selectedRowClass:"jsgrid-selected-row",oddRowClass:"jsgrid-row",evenRowClass:"jsgrid-alt-row",cellClass:"jsgrid-cell",sorting:false,sortableClass:"jsgrid-header-sortable",sortAscClass:"jsgrid-header-sort jsgrid-header-sort-asc",sortDescClass:"jsgrid-header-sort jsgrid-header-sort-desc",paging:false,pagerContainer:null,pageIndex:1,pageSize:20,pageButtonCount:15,pagerFormat:"Pages: {first} {prev} {pages} {next} {last} &nbsp;&nbsp; {pageIndex} of {pageCount}",pagePrevText:"Prev",pageNextText:"Next",pageFirstText:"First",pageLastText:"Last",pageNavigatorNextText:"...",pageNavigatorPrevText:"...",pagerContainerClass:"jsgrid-pager-container",pagerClass:"jsgrid-pager",pagerNavButtonClass:"jsgrid-pager-nav-button",pagerNavButtonInactiveClass:"jsgrid-pager-nav-inactive-button",pageClass:"jsgrid-pager-page",currentPageClass:"jsgrid-pager-current-page",customLoading:false,pageLoading:false,autoload:false,controller:b,loadIndication:true,loadIndicationDelay:500,loadMessage:"Please, wait...",loadShading:true,invalidMessage:"Invalid data entered!",invalidNotify:function(B){var C=a.map(B.errors,function(D){return D.message||null});A.alert([this.invalidMessage].concat(C).join("\n"))},onInit:a.noop,onRefreshing:a.noop,onRefreshed:a.noop,onPageChanged:a.noop,onItemDeleting:a.noop,onItemDeleted:a.noop,onItemInserting:a.noop,onItemInserted:a.noop,onItemEditing:a.noop,onItemUpdating:a.noop,onItemUpdated:a.noop,onItemInvalid:a.noop,onDataLoading:a.noop,onDataLoaded:a.noop,onOptionChanging:a.noop,onOptionChanged:a.noop,onError:a.noop,invalidClass:"jsgrid-invalid",containerClass:"jsgrid",tableClass:"jsgrid-table",gridHeaderClass:"jsgrid-grid-header",gridBodyClass:"jsgrid-grid-body",_init:function(B){a.extend(this,B);this._initLoadStrategy();this._initController();this._initFields();this._attachWindowLoadResize();this._attachWindowResizeCallback();this._callEventHandler(this.onInit)},loadStrategy:function(){return this.pageLoading?new jsGrid.loadStrategies.PageLoadingStrategy(this):new jsGrid.loadStrategies.DirectLoadingStrategy(this)},_initLoadStrategy:function(){this._loadStrategy=f(this.loadStrategy,this)},_initController:function(){this._controller=a.extend({},b,f(this.controller,this))},renderTemplate:function(E,C,B){args=[];for(var D in B){args.push(B[D])}args.unshift(E,C);E=f.apply(null,args);return(E===z||E===null)?"":E},loadIndicator:function(B){return new jsGrid.LoadIndicator(B)},validation:function(B){return jsGrid.Validation&&new jsGrid.Validation(B)},_initFields:function(){var B=this;B.fields=a.map(B.fields,function(C){if(a.isPlainObject(C)){var D=(C.type&&jsGrid.fields[C.type])||jsGrid.Field;C=new D(C)}C._grid=B;return C})},_attachWindowLoadResize:function(){a(A).on("load",a.proxy(this._refreshSize,this))},_attachWindowResizeCallback:function(){if(this.updateOnResize){a(A).on("resize",a.proxy(this._refreshSize,this))}},_detachWindowResizeCallback:function(){a(A).off("resize",this._refreshSize)},option:function(B,E){var D,C;if(arguments.length===1){return this[B]}D={option:B,oldValue:this[B],newValue:E};this._callEventHandler(this.onOptionChanging,D);this._handleOptionChange(D.option,D.newValue);C={option:D.option,value:D.newValue};this._callEventHandler(this.onOptionChanged,C)},fieldOption:function(B,C,D){B=this._normalizeField(B);if(arguments.length===2){return B[C]}B[C]=D;this._renderGrid()},_handleOptionChange:function(B,C){this[B]=C;switch(B){case"width":case"height":this._refreshSize();break;case"rowClass":case"rowRenderer":case"rowClick":case"rowDoubleClick":case"noDataRowClass":case"noDataContent":case"selecting":case"selectedRowClass":case"oddRowClass":case"evenRowClass":this._refreshContent();break;case"pageButtonCount":case"pagerFormat":case"pagePrevText":case"pageNextText":case"pageFirstText":case"pageLastText":case"pageNavigatorNextText":case"pageNavigatorPrevText":case"pagerClass":case"pagerNavButtonClass":case"pageClass":case"currentPageClass":case"pagerRenderer":this._refreshPager();break;case"fields":this._initFields();this.render();break;case"data":case"editing":case"heading":case"filtering":case"inserting":case"paging":this.refresh();break;case"loadStrategy":case"pageLoading":this._initLoadStrategy();this.search();break;case"pageIndex":this.openPage(C);break;case"pageSize":this.refresh();this.search();break;case"editRowRenderer":case"editRowClass":this.cancelEdit();break;case"updateOnResize":this._detachWindowResizeCallback();this._attachWindowResizeCallback();break;case"invalidNotify":case"invalidMessage":break;default:this.render();break}},destroy:function(){this._detachWindowResizeCallback();this._clear();this._container.removeData(j)},render:function(){this._renderGrid();return this.autoload?this.loadData():a.Deferred().resolve().promise()},_renderGrid:function(){this._clear();this._container.addClass(this.containerClass).css("position","relative").append(this._createHeader()).append(this._createBody());this._pagerContainer=this._createPagerContainer();this._loadIndicator=this._createLoadIndicator();this._validation=this._createValidation();this.refresh()},_createLoadIndicator:function(){return f(this.loadIndicator,this,{message:this.loadMessage,shading:this.loadShading,container:this._container})},_createValidation:function(){return f(this.validation,this)},_clear:function(){this.cancelEdit();clearTimeout(this._loadingTimer);this._pagerContainer&&this._pagerContainer.empty();this._container.empty().css({position:"",width:"",height:""})},_createHeader:function(){var E=this._headerRow=this._createHeaderRow(),B=this._filterRow=this._createFilterRow(),F=this._insertRow=this._createInsertRow();var D=this._headerGrid=a("<table>").addClass(this.tableClass).append(E).append(B).append(F);var C=this._header=a("<div>").addClass(this.gridHeaderClass).addClass(this._scrollBarWidth()?"jsgrid-header-scrollbar":"").append(D);return C},_createBody:function(){var D=this._content=a("<tbody>");var C=this._bodyGrid=a("<table>").addClass(this.tableClass).append(D);var B=this._body=a("<div>").addClass(this.gridBodyClass).append(C).on("scroll",a.proxy(function(E){this._header.scrollLeft(E.target.scrollLeft)},this));return B},_createPagerContainer:function(){var B=this.pagerContainer||a("<div>").appendTo(this._container);return a(B).addClass(this.pagerContainerClass)},_eachField:function(B){var C=this;a.each(this.fields,function(E,D){if(D.visible){B.call(C,D,E)}})},_createHeaderRow:function(){if(a.isFunction(this.headerRowRenderer)){return a(this.renderTemplate(this.headerRowRenderer,this))}var B=a("<tr>").addClass(this.headerRowClass);this._eachField(function(D,E){var C=this._prepareCell("<th>",D,"headercss",this.headerCellClass).append(this.renderTemplate(D.headerTemplate,D)).appendTo(B);if(this.sorting&&D.sorting){C.addClass(this.sortableClass).on("click",a.proxy(function(){this.sort(E)},this))}});return B},_prepareCell:function(B,E,D,C){return a(B).css("width",E.width).addClass(C||this.cellClass).addClass((D&&E[D])||E.css).addClass(E.align?("jsgrid-align-"+E.align):"")},_createFilterRow:function(){if(a.isFunction(this.filterRowRenderer)){return a(this.renderTemplate(this.filterRowRenderer,this))}var B=a("<tr>").addClass(this.filterRowClass);this._eachField(function(C){this._prepareCell("<td>",C,"filtercss").append(this.renderTemplate(C.filterTemplate,C)).appendTo(B)});return B},_createInsertRow:function(){if(a.isFunction(this.insertRowRenderer)){return a(this.renderTemplate(this.insertRowRenderer,this))}var B=a("<tr>").addClass(this.insertRowClass);this._eachField(function(C){this._prepareCell("<td>",C,"insertcss").append(this.renderTemplate(C.insertTemplate,C)).appendTo(B)});return B},_callEventHandler:function(C,B){C.call(this,a.extend(B,{grid:this}));return B},reset:function(){this._resetSorting();this._resetPager();return this._loadStrategy.reset()},_resetPager:function(){this._firstDisplayingPage=1;this._setPage(1)},_resetSorting:function(){this._sortField=null;this._sortOrder=x;this._clearSortingCss()},refresh:function(){this._callEventHandler(this.onRefreshing);this.cancelEdit();this._refreshHeading();this._refreshFiltering();this._refreshInserting();this._refreshContent();this._refreshPager();this._refreshSize();this._callEventHandler(this.onRefreshed)},_refreshHeading:function(){this._headerRow.toggle(this.heading)},_refreshFiltering:function(){this._filterRow.toggle(this.filtering)},_refreshInserting:function(){this._insertRow.toggle(this.inserting)},_refreshContent:function(){var B=this._content;B.empty();if(!this.data.length){B.append(this._createNoDataRow());return this}var C=this._loadStrategy.firstDisplayIndex();var D=this._loadStrategy.lastDisplayIndex();for(var F=C;F<D;F++){var E=this.data[F];B.append(this._createRow(E,F))}},_createNoDataRow:function(){var B=0;this._eachField(function(){B++});return a("<tr>").addClass(this.noDataRowClass).append(a("<td>").addClass(this.cellClass).attr("colspan",B).append(this.renderTemplate(this.noDataContent,this)))},_createRow:function(C,D){var B;if(a.isFunction(this.rowRenderer)){B=this.renderTemplate(this.rowRenderer,this,{item:C,itemIndex:D})}else{B=a("<tr>");this._renderCells(B,C)}B.addClass(this._getRowClasses(C,D)).data(l,C).on("click",a.proxy(function(E){this.rowClick({item:C,itemIndex:D,event:E})},this)).on("dblclick",a.proxy(function(E){this.rowDoubleClick({item:C,itemIndex:D,event:E})},this));if(this.selecting){this._attachRowHover(B)}return B},_getRowClasses:function(C,D){var B=[];B.push(((D+1)%2)?this.oddRowClass:this.evenRowClass);B.push(f(this.rowClass,this,C,D));return B.join(" ")},_attachRowHover:function(B){var C=this.selectedRowClass;B.hover(function(){a(this).addClass(C)},function(){a(this).removeClass(C)})},_renderCells:function(B,C){this._eachField(function(D){B.append(this._createCell(C,D))});return this},_createCell:function(F,D){var B;var E=this._getItemFieldValue(F,D);var C={value:E,item:F};if(a.isFunction(D.cellRenderer)){B=this.renderTemplate(D.cellRenderer,D,C)}else{B=a("<td>").append(this.renderTemplate(D.itemTemplate||E,D,C))}return this._prepareCell(B,D)},_getItemFieldValue:function(C,B){var D=B.name.split(".");var E=C[D.shift()];while(E&&D.length){E=E[D.shift()]}return E},_setItemFieldValue:function(D,C,G){var F=C.name.split(".");var B=D;var E=F[0];while(B&&F.length){D=B;E=F.shift();B=D[E]}if(!B){while(F.length){D=D[E]={};E=F.shift()}}D[E]=G},sort:function(B,C){if(a.isPlainObject(B)){C=B.order;B=B.field}this._clearSortingCss();this._setSortingParams(B,C);this._setSortingCss();return this._loadStrategy.sort()},_clearSortingCss:function(){this._headerRow.find("th").removeClass(this.sortAscClass).removeClass(this.sortDescClass)},_setSortingParams:function(B,C){B=this._normalizeField(B);C=C||((this._sortField===B)?this._reversedSortOrder(this._sortOrder):x);this._sortField=B;this._sortOrder=C},_normalizeField:function(B){if(a.isNumeric(B)){return this.fields[B]}if(typeof B==="string"){return a.grep(this.fields,function(C){return C.name===B})[0]}return B},_reversedSortOrder:function(B){return(B===x?y:x)},_setSortingCss:function(){var B=this._visibleFieldIndex(this._sortField);this._headerRow.find("th").eq(B).addClass(this._sortOrder===x?this.sortAscClass:this.sortDescClass)},_visibleFieldIndex:function(B){return a.inArray(B,a.grep(this.fields,function(C){return C.visible}))},_sortData:function(){var B=this._sortFactor(),C=this._sortField;if(C){this.data.sort(function(D,E){return B*C.sortingFunc(D[C.name],E[C.name])})}},_sortFactor:function(){return this._sortOrder===x?1:-1},_itemsCount:function(){return this._loadStrategy.itemsCount()},_pagesCount:function(){var B=this._itemsCount(),C=this.pageSize;return Math.floor(B/C)+(B%C?1:0)},_refreshPager:function(){var B=this._pagerContainer;B.empty();if(this.paging){B.append(this._createPager())}var C=this.paging&&this._pagesCount()>1;B.toggle(C)},_createPager:function(){var B;if(a.isFunction(this.pagerRenderer)){B=a(this.pagerRenderer({pageIndex:this.pageIndex,pageCount:this._pagesCount()}))}else{B=a("<div>").append(this._createPagerByFormat())}B.addClass(this.pagerClass);return B},_createPagerByFormat:function(){var D=this.pageIndex,C=this._pagesCount(),B=this._itemsCount(),E=this.pagerFormat.split(" ");return a.map(E,a.proxy(function(F){var G=F;if(F===t){G=this._createPages()}else{if(F===e){G=this._createPagerNavButton(this.pageFirstText,1,D>1)}else{if(F===u){G=this._createPagerNavButton(this.pagePrevText,D-1,D>1)}else{if(F===p){G=this._createPagerNavButton(this.pageNextText,D+1,D<C)}else{if(F===m){G=this._createPagerNavButton(this.pageLastText,C,D<C)}else{if(F===s){G=D}else{if(F===r){G=C}else{if(F===h){G=B}}}}}}}}return a.isArray(G)?G.concat([" "]):[G," "]},this))},_createPages:function(){var E=this._pagesCount(),D=this.pageButtonCount,B=this._firstDisplayingPage,G=[];if(B>1){G.push(this._createPagerPageNavButton(this.pageNavigatorPrevText,this.showPrevPages))}for(var C=0,F=B;C<D&&F<=E;C++,F++){G.push(F===this.pageIndex?this._createPagerCurrentPage():this._createPagerPage(F))}if((B+D-1)<E){G.push(this._createPagerPageNavButton(this.pageNavigatorNextText,this.showNextPages))}return G},_createPagerNavButton:function(D,C,B){return this._createPagerButton(D,this.pagerNavButtonClass+(B?"":" "+this.pagerNavButtonInactiveClass),B?function(){this.openPage(C)}:a.noop)},_createPagerPageNavButton:function(C,B){return this._createPagerButton(C,this.pagerNavButtonClass,B)},_createPagerPage:function(B){return this._createPagerButton(B,this.pageClass,function(){this.openPage(B)})},_createPagerButton:function(E,C,D){var B=a("<a>").attr("href",c).html(E).on("click",a.proxy(D,this));return a("<span>").addClass(C).append(B)},_createPagerCurrentPage:function(){return a("<span>").addClass(this.pageClass).addClass(this.currentPageClass).text(this.pageIndex)},_refreshSize:function(){this._refreshHeight();this._refreshWidth()},_refreshWidth:function(){var B=(this.width==="auto")?this._getAutoWidth():this.width;this._container.width(B)},_getAutoWidth:function(){var C=this._headerGrid,B=this._header;C.width("auto");var E=C.outerWidth();var D=B.outerWidth()-B.innerWidth();C.width("");return E+D},_scrollBarWidth:(function(){var B;return function(){if(B===z){var C=a("<div style='width:50px;height:50px;overflow:hidden;position:absolute;top:-10000px;left:-10000px;'></div>");var D=a("<div style='height:100px;'></div>");C.append(D).appendTo("body");var E=D.innerWidth();C.css("overflow-y","auto");var F=D.innerWidth();C.remove();B=E-F}return B}})(),_refreshHeight:function(){var B=this._container,E=this._pagerContainer,C=this.height,D;B.height(C);if(C!=="auto"){C=B.height();D=this._header.outerHeight(true);if(E.parents(B).length){D+=E.outerHeight(true)}this._body.outerHeight(C-D)}},showPrevPages:function(){var B=this._firstDisplayingPage,C=this.pageButtonCount;this._firstDisplayingPage=(B>C)?B-C:1;this._refreshPager()},showNextPages:function(){var B=this._firstDisplayingPage,C=this.pageButtonCount,D=this._pagesCount();this._firstDisplayingPage=(B+2*C>D)?D-C+1:B+C;this._refreshPager()},openPage:function(B){if(B<1||B>this._pagesCount()){return}this._setPage(B);this._loadStrategy.openPage(B)},_setPage:function(D){var B=this._firstDisplayingPage,C=this.pageButtonCount;this.pageIndex=D;if(D<B){this._firstDisplayingPage=D}if(D>B+C-1){this._firstDisplayingPage=D-C+1}this._callEventHandler(this.onPageChanged,{pageIndex:D})},_controllerCall:function(E,F,D,C){if(D){return a.Deferred().reject().promise()}this._showLoading();var B=this._controller;if(!B||!B[E]){throw Error("controller has no method '"+E+"'")}return q(B[E](F)).done(a.proxy(C,this)).fail(a.proxy(this._errorHandler,this)).always(a.proxy(this._hideLoading,this))},_errorHandler:function(){this._callEventHandler(this.onError,{args:a.makeArray(arguments)})},_showLoading:function(){if(!this.loadIndication){return}clearTimeout(this._loadingTimer);this._loadingTimer=setTimeout(a.proxy(function(){this._loadIndicator.show()},this),this.loadIndicationDelay)},_hideLoading:function(){if(!this.loadIndication){return}clearTimeout(this._loadingTimer);this._loadIndicator.hide()},search:function(B){this._resetSorting();this._resetPager();return this.loadData(B)},loadData:function(C){C=C||(this.filtering?this.getFilter():{});a.extend(C,this._loadStrategy.loadParams(),this._sortingParams());var B=this._callEventHandler(this.onDataLoading,{filter:C});return this._controllerCall("loadData",C,B.cancel,function(D){if(!D){return}this._loadStrategy.finishLoad(D);this._callEventHandler(this.onDataLoaded,{data:D})})},getFilter:function(){var B={};this._eachField(function(C){if(C.filtering){this._setItemFieldValue(B,C,C.filterValue())}});return B},_sortingParams:function(){if(this.sorting&&this._sortField){return{sortField:this._sortField.name,sortOrder:this._sortOrder}}return{}},getSorting:function(){var B=this._sortingParams();return{field:B.sortField,order:B.sortOrder}},clearFilter:function(){var B=this._createFilterRow();this._filterRow.replaceWith(B);this._filterRow=B;return this.search()},insertItem:function(D){var C=D||this._getValidatedInsertItem();if(!C){return a.Deferred().reject().promise()}var B=this._callEventHandler(this.onItemInserting,{item:C});return this._controllerCall("insertItem",C,B.cancel,function(E){E=E||C;this._loadStrategy.finishInsert(E);this._callEventHandler(this.onItemInserted,{item:E})})},_getValidatedInsertItem:function(){var B=this._getInsertItem();return this._validateItem(B,this._insertRow)?B:null},_getInsertItem:function(){var B={};this._eachField(function(C){if(C.inserting){this._setItemFieldValue(B,C,C.insertValue())}});return B},_validateItem:function(E,B){var F=[];var C={item:E,itemIndex:this._rowIndex(B),row:B};this._eachField(function(H){if(!H.validate||(B===this._insertRow&&!H.inserting)||(B===this._getEditRow()&&!H.editing)){return}var I=this._getItemFieldValue(E,H);var G=this._validation.validate(a.extend({value:I,rules:H.validate},C));this._setCellValidity(B.children().eq(this._visibleFieldIndex(H)),G);if(!G.length){return}F.push.apply(F,a.map(G,function(J){return{field:H,message:J}}))});if(!F.length){return true}var D=a.extend({errors:F},C);this._callEventHandler(this.onItemInvalid,D);this.invalidNotify(D);return false},_setCellValidity:function(B,C){B.toggleClass(this.invalidClass,!!C.length).attr("title",C.join("\n"))},clearInsert:function(){var B=this._createInsertRow();this._insertRow.replaceWith(B);this._insertRow=B;this.refresh()},editItem:function(C){var B=this.rowByItem(C);if(B.length){this._editRow(B)}},rowByItem:function(B){if(B.jquery||B.nodeType){return a(B)}return this._content.find("tr").filter(function(){return a.data(this,l)===B})},_editRow:function(C){if(!this.editing){return}var E=C.data(l);var D=this._callEventHandler(this.onItemEditing,{row:C,item:E,itemIndex:this._itemIndex(E)});if(D.cancel){return}if(this._editingRow){this.cancelEdit()}var B=this._createEditRow(E);this._editingRow=C;C.hide();B.insertBefore(C);C.data(k,B)},_createEditRow:function(C){if(a.isFunction(this.editRowRenderer)){return a(this.renderTemplate(this.editRowRenderer,this,{item:C,itemIndex:this._itemIndex(C)}))}var B=a("<tr>").addClass(this.editRowClass);this._eachField(function(D){var E=this._getItemFieldValue(C,D);this._prepareCell("<td>",D,"editcss").append(this.renderTemplate(D.editTemplate||"",D,{value:E,item:C})).appendTo(B)});return B},updateItem:function(D,C){if(arguments.length===1){C=D}var B=D?this.rowByItem(D):this._editingRow;C=C||this._getValidatedEditedItem();if(!C){return}return this._updateRow(B,C)},_getValidatedEditedItem:function(){var B=this._getEditedItem();return this._validateItem(B,this._getEditRow())?B:null},_updateRow:function(B,D){var F=B.data(l),G=this._itemIndex(F),E=a.extend(true,{},F,D);var C=this._callEventHandler(this.onItemUpdating,{row:B,item:E,itemIndex:G,previousItem:F});return this._controllerCall("updateItem",E,C.cancel,function(I){var J=a.extend(true,{},F);E=I||a.extend(true,F,D);var H=this._finishUpdate(B,E,G);this._callEventHandler(this.onItemUpdated,{row:H,item:E,itemIndex:G,previousItem:J})})},_rowIndex:function(B){return this._content.children().index(a(B))},_itemIndex:function(B){return a.inArray(B,this.data)},_finishUpdate:function(C,D,E){this.cancelEdit();this.data[E]=D;var B=this._createRow(D,E);C.replaceWith(B);return B},_getEditedItem:function(){var B={};this._eachField(function(C){if(C.editing){this._setItemFieldValue(B,C,C.editValue())}});return B},cancelEdit:function(){if(!this._editingRow){return}this._getEditRow().remove();this._editingRow.show();this._editingRow=null},_getEditRow:function(){return this._editingRow&&this._editingRow.data(k)},deleteItem:function(C){var B=this.rowByItem(C);if(!B.length){return}if(this.confirmDeleting&&!A.confirm(f(this.deleteConfirm,this,B.data(l)))){return}return this._deleteRow(B)},_deleteRow:function(B){var D=B.data(l),E=this._itemIndex(D);var C=this._callEventHandler(this.onItemDeleting,{row:B,item:D,itemIndex:E});return this._controllerCall("deleteItem",D,C.cancel,function(){this._loadStrategy.finishDelete(D,E);this._callEventHandler(this.onItemDeleted,{row:B,item:D,itemIndex:E})})}};a.fn.jsGrid=function(C){var B=a.makeArray(arguments),D=B.slice(1),E=this;this.each(function(){var F=a(this),G=F.data(j),H;if(G){if(typeof C==="string"){H=G[C].apply(G,D);if(H!==z&&H!==G){E=H;return false}}else{G._detachWindowResizeCallback();G._init(C);G.render()}}else{new g(F,C)}});return E};var d={};var v=function(C){var B;if(a.isPlainObject(C)){B=g.prototype}else{B=d[C].prototype;C=arguments[1]||{}}a.extend(B,C)};var o={};var n=function(B){var C=a.isPlainObject(B)?B:o[B];if(!C){throw Error("unknown locale "+B)}w(jsGrid,C)};var w=function(C,B){a.each(B,function(D,E){if(a.isPlainObject(E)){w(C[D]||C[D[0].toUpperCase()+D.slice(1)],E);return}if(C.hasOwnProperty(D)){C[D]=E}else{C.prototype[D]=E}})};A.jsGrid={Grid:g,fields:d,setDefaults:v,locales:o,locale:n,version:"1.5.3"}}(window,jQuery));(function(b,a,d){function c(e){this._init(e)}c.prototype={container:"body",message:"Loading...",shading:true,zIndex:1000,shaderClass:"jsgrid-load-shader",loadPanelClass:"jsgrid-load-panel",_init:function(e){a.extend(true,this,e);this._initContainer();this._initShader();this._initLoadPanel()},_initContainer:function(){this._container=a(this.container)},_initShader:function(){if(!this.shading){return}this._shader=a("<div>").addClass(this.shaderClass).hide().css({position:"absolute",top:0,right:0,bottom:0,left:0,zIndex:this.zIndex}).appendTo(this._container)},_initLoadPanel:function(){this._loadPanel=a("<div>").addClass(this.loadPanelClass).text(this.message).hide().css({position:"absolute",top:"50%",left:"50%",zIndex:this.zIndex}).appendTo(this._container)},show:function(){var e=this._loadPanel.show();var g=e.outerWidth();var f=e.outerHeight();e.css({marginTop:-f/2,marginLeft:-g/2});this._shader.show()},hide:function(){this._loadPanel.hide();this._shader.hide()}};b.LoadIndicator=c}(jsGrid,jQuery));(function(c,a,e){function b(f){this._grid=f}b.prototype={firstDisplayIndex:function(){var f=this._grid;return f.option("paging")?(f.option("pageIndex")-1)*f.option("pageSize"):0},lastDisplayIndex:function(){var f=this._grid;var g=f.option("data").length;return f.option("paging")?Math.min(f.option("pageIndex")*f.option("pageSize"),g):g},itemsCount:function(){return this._grid.option("data").length},openPage:function(f){this._grid.refresh()},loadParams:function(){return{}},sort:function(){this._grid._sortData();this._grid.refresh();return a.Deferred().resolve().promise()},reset:function(){this._grid.refresh();return a.Deferred().resolve().promise()},finishLoad:function(f){this._grid.option("data",f)},finishInsert:function(g){var f=this._grid;f.option("data").push(g);f.refresh()},finishDelete:function(f,g){var h=this._grid;h.option("data").splice(g,1);h.reset()}};function d(f){this._grid=f;this._itemsCount=0}d.prototype={firstDisplayIndex:function(){return 0},lastDisplayIndex:function(){return this._grid.option("data").length},itemsCount:function(){return this._itemsCount},openPage:function(f){this._grid.loadData()},loadParams:function(){var f=this._grid;return{pageIndex:f.option("pageIndex"),pageSize:f.option("pageSize")}},reset:function(){return this._grid.loadData()},sort:function(){return this._grid.loadData()},finishLoad:function(f){this._itemsCount=f.itemsCount;this._grid.option("data",f.data)},finishInsert:function(f){this._grid.search()},finishDelete:function(f,g){this._grid.search()}};c.loadStrategies={DirectLoadingStrategy:b,PageLoadingStrategy:d}}(jsGrid,jQuery));(function(c,a,e){var b=function(f){return typeof(f)!=="undefined"&&f!==null};var d={string:function(f,g){if(!b(f)&&!b(g)){return 0}if(!b(f)){return -1}if(!b(g)){return 1}return(""+f).localeCompare(""+g)},number:function(f,g){return f-g},date:function(f,g){return f-g},numberAsString:function(f,g){return parseFloat(f)-parseFloat(g)}};c.sortStrategies=d}(jsGrid,jQuery));(function(b,a,c){function d(f){this._init(f)}d.prototype={_init:function(f){a.extend(true,this,f)},validate:function(f){var g=[];a.each(this._normalizeRules(f.rules),function(h,j){if(j.validator(f.value,f.item,j.param)){return}var i=a.isFunction(j.message)?j.message(f.value,f.item):j.message;g.push(i)});return g},_normalizeRules:function(f){if(!a.isArray(f)){f=[f]}return a.map(f,a.proxy(function(g){return this._normalizeRule(g)},this))},_normalizeRule:function(f){if(typeof f==="string"){f={validator:f}}if(a.isFunction(f)){f={validator:f}}if(a.isPlainObject(f)){f=a.extend({},f)}else{throw Error("wrong validation config specified")}if(a.isFunction(f.validator)){return f}return this._applyNamedValidator(f,f.validator)},_applyNamedValidator:function(f,h){delete f.validator;var g=e[h];if(!g){throw Error('unknown validator "'+h+'"')}if(a.isFunction(g)){g={validator:g}}return a.extend({},g,f)}};b.Validation=d;var e={required:{message:"Field is required",validator:function(f){return f!==c&&f!==null&&f!==""}},rangeLength:{message:"Field value length is out of the defined range",validator:function(h,f,g){return h.length>=g[0]&&h.length<=g[1]}},minLength:{message:"Field value is too short",validator:function(h,f,g){return h.length>=g}},maxLength:{message:"Field value is too long",validator:function(h,f,g){return h.length<=g}},pattern:{message:"Field value is not matching the defined pattern",validator:function(h,f,g){if(typeof g==="string"){g=new RegExp("^(?:"+g+")$")}return g.test(h)}},range:{message:"Field value is out of the defined range",validator:function(h,f,g){return h>=g[0]&&h<=g[1]}},min:{message:"Field value is too small",validator:function(h,f,g){return h>=g}},max:{message:"Field value is too large",validator:function(h,f,g){return h<=g}}};b.validators=e}(jsGrid,jQuery));(function(c,a,d){function b(e){a.extend(true,this,e);this.sortingFunc=this._getSortingFunc()}b.prototype={name:"",title:null,css:"",align:"",width:100,visible:true,filtering:true,inserting:true,editing:true,sorting:true,sorter:"string",headerTemplate:function(){return(this.title===d||this.title===null)?this.name:this.title},itemTemplate:function(f,e){return f},filterTemplate:function(){return""},insertTemplate:function(){return""},editTemplate:function(f,e){this._value=f;return this.itemTemplate(f,e)},filterValue:function(){return""},insertValue:function(){return""},editValue:function(){return this._value},_getSortingFunc:function(){var e=this.sorter;if(a.isFunction(e)){return e}if(typeof e==="string"){return c.sortStrategies[e]}throw Error('wrong sorter for the field "'+this.name+'"!')}};c.Field=b}(jsGrid,jQuery));(function(c,a,e){var b=c.Field;function d(f){b.call(this,f)}d.prototype=new b({autosearch:true,readOnly:false,filterTemplate:function(){if(!this.filtering){return""}var g=this._grid,f=this.filterControl=this._createTextBox();if(this.autosearch){f.on("keypress",function(h){if(h.which===13){g.search();h.preventDefault()}})}return f},insertTemplate:function(){if(!this.inserting){return""}return this.insertControl=this._createTextBox()},editTemplate:function(g){if(!this.editing){return this.itemTemplate.apply(this,arguments)}var f=this.editControl=this._createTextBox();f.val(g);return f},filterValue:function(){return this.filterControl.val()},insertValue:function(){return this.insertControl.val()},editValue:function(){return this.editControl.val()},_createTextBox:function(){return a("<input>").attr("type","text").prop("readonly",!!this.readOnly)}});c.fields.text=c.TextField=d}(jsGrid,jQuery));(function(b,a,e){var d=b.TextField;function c(f){d.call(this,f)}c.prototype=new d({sorter:"number",align:"right",readOnly:false,filterValue:function(){return this.filterControl.val()?parseInt(this.filterControl.val()||0,10):e},insertValue:function(){return this.insertControl.val()?parseInt(this.insertControl.val()||0,10):e},editValue:function(){return this.editControl.val()?parseInt(this.editControl.val()||0,10):e},_createTextBox:function(){return a("<input>").attr("type","number").prop("readonly",!!this.readOnly)}});b.fields.number=b.NumberField=c}(jsGrid,jQuery));(function(b,a,e){var d=b.TextField;function c(f){d.call(this,f)}c.prototype=new d({insertTemplate:function(){if(!this.inserting){return""}return this.insertControl=this._createTextArea()},editTemplate:function(g){if(!this.editing){return this.itemTemplate.apply(this,arguments)}var f=this.editControl=this._createTextArea();f.val(g);return f},_createTextArea:function(){return a("<textarea>").prop("readonly",!!this.readOnly)}});b.fields.textarea=b.TextAreaField=c}(jsGrid,jQuery));(function(b,a,g){var c=b.NumberField;var d="number";var f="string";function e(h){this.items=[];this.selectedIndex=-1;this.valueField="";this.textField="";if(h.valueField&&h.items.length){var i=h.items[0][h.valueField];this.valueType=(typeof i)===d?d:f}this.sorter=this.valueType;c.call(this,h)}e.prototype=new c({align:"center",valueType:d,itemTemplate:function(l){var h=this.items,m=this.valueField,k=this.textField,j;if(m){j=a.grep(h,function(o,n){return o[m]===l})[0]||{}}else{j=h[l]}var i=(k?j[k]:j);return(i===g||i===null)?"":i},filterTemplate:function(){if(!this.filtering){return""}var i=this._grid,h=this.filterControl=this._createSelect();if(this.autosearch){h.on("change",function(j){i.search()})}return h},insertTemplate:function(){if(!this.inserting){return""}return this.insertControl=this._createSelect()},editTemplate:function(i){if(!this.editing){return this.itemTemplate.apply(this,arguments)}var h=this.editControl=this._createSelect();(i!==g)&&h.val(i);return h},filterValue:function(){var h=this.filterControl.val();return this.valueType===d?parseInt(h||0,10):h},insertValue:function(){var h=this.insertControl.val();return this.valueType===d?parseInt(h||0,10):h},editValue:function(){var h=this.editControl.val();return this.valueType===d?parseInt(h||0,10):h},_createSelect:function(){var h=a("<select>"),k=this.valueField,j=this.textField,i=this.selectedIndex;a.each(this.items,function(m,n){var p=k?n[k]:m,o=j?n[j]:n;var l=a("<option>").attr("value",p).text(o).appendTo(h);l.prop("selected",(i===m))});h.prop("disabled",!!this.readOnly);return h}});b.fields.select=b.SelectField=e}(jsGrid,jQuery));(function(d,a,e){var c=d.Field;function b(f){c.call(this,f)}b.prototype=new c({sorter:"number",align:"center",autosearch:true,itemTemplate:function(f){return this._createCheckbox().prop({checked:f,disabled:true})},filterTemplate:function(){if(!this.filtering){return""}var g=this._grid,f=this.filterControl=this._createCheckbox();f.prop({readOnly:true,indeterminate:true});f.on("click",function(){var h=a(this);if(h.prop("readOnly")){h.prop({checked:false,readOnly:false})}else{if(!h.prop("checked")){h.prop({readOnly:true,indeterminate:true})}}});if(this.autosearch){f.on("click",function(){g.search()})}return f},insertTemplate:function(){if(!this.inserting){return""}return this.insertControl=this._createCheckbox()},editTemplate:function(g){if(!this.editing){return this.itemTemplate.apply(this,arguments)}var f=this.editControl=this._createCheckbox();f.prop("checked",g);return f},filterValue:function(){return this.filterControl.get(0).indeterminate?e:this.filterControl.is(":checked")},insertValue:function(){return this.insertControl.is(":checked")},editValue:function(){return this.editControl.is(":checked")},_createCheckbox:function(){return a("<input>").attr("type","checkbox")}});d.fields.checkbox=d.CheckboxField=b}(jsGrid,jQuery));(function(d,a,e){var c=d.Field;function b(f){c.call(this,f);this._configInitialized=false}b.prototype=new c({css:"jsgrid-control-field",align:"center",width:50,filtering:false,inserting:false,editing:false,sorting:false,buttonClass:"jsgrid-button",modeButtonClass:"jsgrid-mode-button",modeOnButtonClass:"jsgrid-mode-on-button",searchModeButtonClass:"jsgrid-search-mode-button",insertModeButtonClass:"jsgrid-insert-mode-button",editButtonClass:"jsgrid-edit-button",deleteButtonClass:"jsgrid-delete-button",searchButtonClass:"jsgrid-search-button",clearFilterButtonClass:"jsgrid-clear-filter-button",insertButtonClass:"jsgrid-insert-button",updateButtonClass:"jsgrid-update-button",cancelEditButtonClass:"jsgrid-cancel-edit-button",searchModeButtonTooltip:"Switch to searching",insertModeButtonTooltip:"Switch to inserting",editButtonTooltip:"Edit",deleteButtonTooltip:"Delete",searchButtonTooltip:"Search",clearFilterButtonTooltip:"Clear filter",insertButtonTooltip:"Insert",updateButtonTooltip:"Update",cancelEditButtonTooltip:"Cancel edit",editButton:true,deleteButton:true,clearFilterButton:true,modeSwitchButton:true,_initConfig:function(){this._hasFiltering=this._grid.filtering;this._hasInserting=this._grid.inserting;if(this._hasInserting&&this.modeSwitchButton){this._grid.inserting=false}this._configInitialized=true},headerTemplate:function(){if(!this._configInitialized){this._initConfig()}var f=this._hasFiltering;var g=this._hasInserting;if(!this.modeSwitchButton||(!f&&!g)){return""}if(f&&!g){return this._createFilterSwitchButton()}if(g&&!f){return this._createInsertSwitchButton()}return this._createModeSwitchButton()},itemTemplate:function(h,g){var f=a([]);if(this.editButton){f=f.add(this._createEditButton(g))}if(this.deleteButton){f=f.add(this._createDeleteButton(g))}return f},filterTemplate:function(){var f=this._createSearchButton();return this.clearFilterButton?f.add(this._createClearFilterButton()):f},insertTemplate:function(){return this._createInsertButton()},editTemplate:function(){return this._createUpdateButton().add(this._createCancelEditButton())},_createFilterSwitchButton:function(){return this._createOnOffSwitchButton("filtering",this.searchModeButtonClass,true)},_createInsertSwitchButton:function(){return this._createOnOffSwitchButton("inserting",this.insertModeButtonClass,false)},_createOnOffSwitchButton:function(j,g,i){var h=i;var k=a.proxy(function(){f.toggleClass(this.modeOnButtonClass,h)},this);var f=this._createGridButton(this.modeButtonClass+" "+g,"",function(l){h=!h;l.option(j,h);k()});k();return f},_createModeSwitchButton:function(){var g=false;var h=a.proxy(function(){f.attr("title",g?this.searchModeButtonTooltip:this.insertModeButtonTooltip).toggleClass(this.insertModeButtonClass,!g).toggleClass(this.searchModeButtonClass,g)},this);var f=this._createGridButton(this.modeButtonClass,"",function(i){g=!g;i.option("inserting",g);i.option("filtering",!g);h()});h();return f},_createEditButton:function(f){return this._createGridButton(this.editButtonClass,this.editButtonTooltip,function(h,g){h.editItem(f);g.stopPropagation()})},_createDeleteButton:function(f){return this._createGridButton(this.deleteButtonClass,this.deleteButtonTooltip,function(h,g){h.deleteItem(f);g.stopPropagation()})},_createSearchButton:function(){return this._createGridButton(this.searchButtonClass,this.searchButtonTooltip,function(f){f.search()})},_createClearFilterButton:function(){return this._createGridButton(this.clearFilterButtonClass,this.clearFilterButtonTooltip,function(f){f.clearFilter()})},_createInsertButton:function(){return this._createGridButton(this.insertButtonClass,this.insertButtonTooltip,function(f){f.insertItem().done(function(){f.clearInsert()})})},_createUpdateButton:function(){return this._createGridButton(this.updateButtonClass,this.updateButtonTooltip,function(g,f){g.updateItem();f.stopPropagation()})},_createCancelEditButton:function(){return this._createGridButton(this.cancelEditButtonClass,this.cancelEditButtonTooltip,function(g,f){g.cancelEdit();f.stopPropagation()})},_createGridButton:function(g,i,f){var h=this._grid;return a("<input>").addClass(this.buttonClass).addClass(g).attr({type:"button",title:i}).on("click",function(j){f(h,j)})},editValue:function(){return""}});d.fields.control=d.ControlField=b}(jsGrid,jQuery));